---
import BaseLayout from "../layouts/BaseLayout.astro";
import { site } from "../data/site";
import { Image } from "astro:assets";

type Project = { title: string; desc: string; href: string };
const groups: { name: string; items: Project[] }[] = [
  {
    name: 'Meme',
    items: [
      { title: 'Career Limiting Maneuver', desc: 'Career Limiting Maneuver', href: 'https://careerlimitingmaneuver.com/' },
      { title: 'Career Limiting Together', desc: 'See everyone making a career limiting maneuver', href: 'https://multiplayer.careerlimitingmaneuver.com/' },
    ],
  },
];

function iconUrl(href: string) {
  try {
    const u = new URL(href);
    return `https://icons.duckduckgo.com/ip3/${u.hostname}.ico`;
  } catch {
    return `https://icons.duckduckgo.com/ip3/${href}.ico`;
  }
}
---

<BaseLayout title={`Projects — ${site.name}`} description="Selected projects" current="projects">
  <section class="hero">
    <h1>Projects</h1>
    <p class="lead">Selected things I’m building and running.</p>
  </section>

  {groups.map((g) => (
    <section class="section">
      <h2>{g.name}</h2>
      <div class="card-grid">
        {g.items.map((p) => (
          <a class="card project" href={p.href} target="_blank" rel="noopener noreferrer" aria-label={`${p.title} — ${p.desc}`}>
            <div class="project-head">
              <Image src={iconUrl(p.href)} alt="" width={18} height={18} class="favicon" loading="eager" />
              <span class="title">{p.title}</span>
              <span class="arrow" aria-hidden="true">→</span>
            </div>
            <p class="meta">{p.desc}</p>
          </a>
        ))}
      </div>
    </section>
  ))}
</BaseLayout>

<style>
  .card.project { display: block; text-decoration: none; }
  .card.project:hover { background: rgba(255,255,255,0.03); border-color: color-mix(in oklab, var(--link) 25%, var(--border)); }
  .project-head { display: flex; align-items: center; gap: 8px; color: var(--text); font-weight: 600; }
  .favicon { width: 18px; height: 18px; border-radius: 4px; }
  .arrow { margin-left: auto; color: var(--muted); transition: transform .15s ease, color .15s ease; }
  .card.project:hover .arrow { transform: translateX(2px); color: var(--text); }
</style>
